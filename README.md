# TritonPart ç‹¬ç«‹ç‰ˆæœ¬

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

TritonPart æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„è¶…å¤§è§„æ¨¡é›†æˆç”µè·¯ï¼ˆVLSIï¼‰åˆ†åŒºå·¥å…·ï¼ŒåŸæœ¬æ˜¯ OpenROAD é¡¹ç›®çš„ä¸€éƒ¨åˆ†ã€‚æœ¬é¡¹ç›®æˆåŠŸåœ°å°† TritonPart ä» OpenROAD ä¸­æå–å‡ºæ¥ï¼Œå½¢æˆäº†ä¸€ä¸ªç‹¬ç«‹çš„å·¥å…·ï¼Œå¹¶å®Œæ•´é›†æˆäº† OpenSTA æ—¶åºåˆ†æå¼•æ“ï¼Œæ”¯æŒæ—¶åºæ„ŸçŸ¥çš„å¤šè·¯åˆ†åŒºã€‚

### ä¸»è¦ç‰¹æ€§

- ğŸ¯ **å¤šè·¯åˆ†åŒº**: æ”¯æŒ 2ã€4ã€8 ç­‰ä»»æ„æ•°é‡çš„åˆ†åŒº
- â±ï¸ **æ—¶åºæ„ŸçŸ¥**: é›†æˆ OpenSTA è¿›è¡Œå…³é”®è·¯å¾„åˆ†æ
- ğŸ“ˆ **å¤§è§„æ¨¡æ”¯æŒ**: å¯å¤„ç†è¶…è¿‡ 13 ä¸‡ä¸ªå•å…ƒçš„è®¾è®¡
- ğŸ”§ **ç‹¬ç«‹è¿è¡Œ**: æ— éœ€ OpenROAD ç¯å¢ƒ
- ğŸ“š **å¤šæ ¼å¼æ”¯æŒ**: Verilogã€Libertyã€SDC æ–‡ä»¶

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- C++17 æˆ–æ›´é«˜ç‰ˆæœ¬
- CMake 3.14+
- TCL 8.6+
- å¯é€‰ï¼šOR-Toolsï¼ˆç”¨äº ILP ä¼˜åŒ–ï¼‰

### ç¼–è¯‘å®‰è£…

```bash
# å…‹éš†ä»“åº“
cd /home/lzx/work/OpenROAD-flow-scripts/partition

# åˆ›å»ºæ„å»ºç›®å½•
mkdir -p build && cd build

# é…ç½®é¡¹ç›®
cmake .. -DCMAKE_BUILD_TYPE=Release

# ç¼–è¯‘
make tritonpart -j$(nproc)

# å¯æ‰§è¡Œæ–‡ä»¶ä½ç½®: build/bin/tritonpart
```

## ğŸ“˜ ä½¿ç”¨æ–¹æ³•

### å‘½ä»¤è¡Œå‚æ•°

```bash
./build/bin/tritonpart [é€‰é¡¹]
```

| å‚æ•° | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `-v <æ–‡ä»¶>` | Verilog ç½‘è¡¨æ–‡ä»¶ | `-v design.v` |
| `-l <æ–‡ä»¶>` | Liberty åº“æ–‡ä»¶ | `-l Nangate45.lib` |
| `-s <æ–‡ä»¶>` | SDC çº¦æŸæ–‡ä»¶ | `-s constraints.sdc` |
| `-m <æ¨¡å—>` | é¡¶å±‚æ¨¡å—å | `-m top_module` |
| `-n <æ•°é‡>` | åˆ†åŒºæ•°é‡ï¼ˆé»˜è®¤ï¼š2ï¼‰ | `-n 4` |
| `-b <æ¯”ä¾‹>` | å¹³è¡¡çº¦æŸï¼ˆé»˜è®¤ï¼š1.1ï¼‰ | `-b 1.05` |
| `-t` | å¯ç”¨æ—¶åºæ„ŸçŸ¥åˆ†åŒº | `-t` |
| `-o <æ–‡ä»¶>` | è¾“å‡ºæ–‡ä»¶ï¼ˆé»˜è®¤ï¼špartition.txtï¼‰ | `-o result.txt` |
| `-d` | å¯ç”¨è°ƒè¯•æ—¥å¿— | `-d` |
| `-h` | æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯ | `-h` |

### ä½¿ç”¨ç¤ºä¾‹

#### 1. åŸºç¡€ 4 è·¯åˆ†åŒº
```bash
./build/bin/tritonpart \
  -v design.v \
  -l library.lib \
  -m top_module \
  -n 4
```

#### 2. æ—¶åºæ„ŸçŸ¥åˆ†åŒº
```bash
./build/bin/tritonpart \
  -v design.v \
  -l library.lib \
  -s constraints.sdc \
  -m top_module \
  -n 4 \
  -t
```

#### 3. Ariane å¤„ç†å™¨ç¤ºä¾‹
```bash
./build/bin/tritonpart \
  -v /home/lzx/work/OpenROAD-flow-scripts/tools/OpenROAD/src/par/examples/timing-aware-partitioning/ariane.v \
  -l /home/lzx/work/OpenROAD-flow-scripts/tools/OpenROAD/src/par/examples/timing-aware-partitioning/Nangate45/Nangate45_typ.lib \
  -s /home/lzx/work/OpenROAD-flow-scripts/tools/OpenROAD/src/par/examples/timing-aware-partitioning/ariane.sdc \
  -m ariane \
  -n 4 \
  -t
```

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
partition/
â”œâ”€â”€ build/                      # æ„å»ºç›®å½•
â”‚   â”œâ”€â”€ bin/tritonpart         # ä¸»ç¨‹åº
â”‚   â””â”€â”€ lib/                   # é™æ€åº“
â”œâ”€â”€ src/                       # æºä»£ç 
â”‚   â”œâ”€â”€ adapter/              # ç½‘è¡¨é€‚é…å™¨
â”‚   â”‚   â”œâ”€â”€ OpenStaAdapter.cpp        # OpenSTA é€‚é…å™¨ä¸»å®ç°
â”‚   â”‚   â”œâ”€â”€ OpenStaAdapter_timing.cpp # æ—¶åºè·¯å¾„æå–
â”‚   â”‚   â””â”€â”€ NetlistAdapter.h          # é€‚é…å™¨æ¥å£
â”‚   â”œâ”€â”€ src/                           # æ ¸å¿ƒç®—æ³•
â”‚   â”‚   â”œâ”€â”€ Hypergraph.cpp           # è¶…å›¾æ•°æ®ç»“æ„
â”‚   â”‚   â”œâ”€â”€ Coarsener.cpp            # ç²—åŒ–ç®—æ³•
â”‚   â”‚   â”œâ”€â”€ Partitioner.cpp          # åˆ†åŒºç®—æ³•
â”‚   â”‚   â”œâ”€â”€ KWayFMRefine.cpp         # FM ä¼˜åŒ–ç®—æ³•
â”‚   â”‚   â””â”€â”€ ...
â”‚   â”œâ”€â”€ utils/                        # å·¥å…·ç±»
â”‚   â”‚   â””â”€â”€ Logger.h                  # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”œâ”€â”€ TritonPartCore.cpp           # æ ¸å¿ƒåè°ƒå™¨
â”‚   â””â”€â”€ test_complete_flow.cpp       # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ lib/sta/                         # OpenSTA åº“ï¼ˆå­æ¨¡å—ï¼‰
â”œâ”€â”€ examples/                         # ç¤ºä¾‹è„šæœ¬
â”œâ”€â”€ test_timing_paths.tcl            # æ—¶åºæµ‹è¯•è„šæœ¬
â””â”€â”€ CMakeLists.txt                   # CMake é…ç½®
```

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

ä»¥ Ariane RISC-V å¤„ç†å™¨ä¸ºä¾‹ï¼š

| æŒ‡æ ‡ | æ•°å€¼ |
|------|------|
| **è®¾è®¡è§„æ¨¡** | 134,920 ä¸ªå®ä¾‹ |
| **ç½‘ç»œæ•°é‡** | 162,256 ä¸ª |
| **è¶…å›¾é¡¶ç‚¹** | 162,256 ä¸ª |
| **è¶…å›¾è¾¹** | 134,920 æ¡ |
| **æ—¶åºè·¯å¾„** | 200 æ¡ï¼ˆå¯é…ç½®ï¼‰ |
| **è¿è¡Œæ—¶é—´** | ~29 ç§’ |
| **å†…å­˜å ç”¨** | < 2GB |
| **åˆ†åŒºè´¨é‡** | 122,234 æ¡å‰²è¾¹ |

## ğŸ”¬ æŠ€æœ¯ç»†èŠ‚

### æ ¸å¿ƒç®—æ³•

1. **å¤šçº§åˆ†åŒºæ¡†æ¶**
   - ç²—åŒ–é˜¶æ®µï¼šHeavy Edge Matching (HEM)
   - åˆå§‹åˆ†åŒºï¼šéšæœºæˆ–è°±æ–¹æ³•
   - ç»†åŒ–é˜¶æ®µï¼šFM/KL å¯å‘å¼ç®—æ³•

2. **æ—¶åºæ„ŸçŸ¥ä¼˜åŒ–**
   - OpenSTA é›†æˆå®ç°æ—¶åºåˆ†æ
   - å…³é”®è·¯å¾„æå–å’Œæƒé‡è°ƒæ•´
   - Slack ä¼ æ’­ç®—æ³•

3. **è¶…å›¾è¡¨ç¤º**
   - é¡¶ç‚¹ï¼šç”µè·¯å®ä¾‹ï¼ˆæ ‡å‡†å•å…ƒã€å®å•å…ƒï¼‰
   - è¶…è¾¹ï¼šç½‘ç»œè¿æ¥
   - æƒé‡ï¼šé¢ç§¯ã€æ—¶åºå…³é”®æ€§

### OpenSTA é›†æˆ

æœ¬é¡¹ç›®å®Œæ•´é›†æˆäº† OpenSTA æ—¶åºåˆ†æå¼•æ“ï¼š

- **TCL/Swig ç»‘å®š**: å®Œæ•´çš„ TCL å‘½ä»¤æ”¯æŒ
- **Liberty è§£æ**: æ”¯æŒæ ‡å‡†å•å…ƒåº“
- **Verilog è¯»å–**: å±‚æ¬¡åŒ–ç½‘è¡¨æ”¯æŒ
- **SDC çº¦æŸ**: æ—¶åºçº¦æŸå¤„ç†
- **è·¯å¾„åˆ†æ**: Setup/Hold æ—¶åºè·¯å¾„æå–

## ğŸ§ª æµ‹è¯•

### è¿è¡Œæµ‹è¯•è„šæœ¬
```bash
# åŸºç¡€åŠŸèƒ½æµ‹è¯•
./examples/test_opensta_real.sh

# OpenROAD ç¤ºä¾‹æµ‹è¯•
./examples/test_with_openroad_example.sh

# æ—¶åºè·¯å¾„æµ‹è¯•
lib/sta/build/sta test_timing_paths.tcl -exit
```

### éªŒè¯è¾“å‡º
ç¨‹åºä¼šç”Ÿæˆ `partition.txt` æ–‡ä»¶ï¼ŒåŒ…å«ï¼š
- æ¯ä¸ªé¡¶ç‚¹çš„åˆ†åŒºåˆ†é…
- åˆ†åŒºç»Ÿè®¡ä¿¡æ¯
- å‰²è¾¹æ•°é‡
- æ—¶åºè·¯å¾„åˆ‡å‰²æƒ…å†µ

## ğŸ› å·²çŸ¥é—®é¢˜

1. **fakeram æ¨¡å—è­¦å‘Š**: æŸäº›å†…å­˜æ¨¡å—ä¼šåˆ›å»ºé»‘ç›’ï¼Œä¸å½±å“åˆ†åŒºç»“æœ
2. **æ—¶åºè·¯å¾„æ•°é‡**: é»˜è®¤é™åˆ¶ 200 æ¡ï¼Œå¯é€šè¿‡ä¿®æ”¹ä»£ç å¢åŠ 
3. **å†…å­˜å ç”¨**: è¶…å¤§è®¾è®¡ï¼ˆ>50 ä¸‡å®ä¾‹ï¼‰å¯èƒ½éœ€è¦è°ƒæ•´å†…å­˜é™åˆ¶

## ğŸ“ˆ ä¼˜åŒ–å»ºè®®

1. **å¹³è¡¡çº¦æŸ**: æ ¹æ®è®¾è®¡ç‰¹ç‚¹è°ƒæ•´ `-b` å‚æ•°ï¼ˆ1.0-1.2ï¼‰
2. **åˆ†åŒºæ•°é‡**: é€šå¸¸é€‰æ‹© 2 çš„å¹‚æ¬¡æ–¹ä»¥è·å¾—æœ€ä½³æ€§èƒ½
3. **æ—¶åºæƒé‡**: å¯åœ¨ä»£ç ä¸­è°ƒæ•´å…³é”®è·¯å¾„æƒé‡ç³»æ•°

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

ä¸»è¦æ”¹è¿›æ–¹å‘ï¼š
- å¹¶è¡ŒåŒ–ç®—æ³•ä¼˜åŒ–
- æ›´å¤šåˆ†åŒºç®—æ³•æ”¯æŒ
- GUI ç•Œé¢å¼€å‘
- Python ç»‘å®š

## ğŸ“„ è®¸å¯è¯

BSD 3-Clause Licenseï¼ˆä¸ OpenROAD ä¿æŒä¸€è‡´ï¼‰

## ğŸ™ è‡´è°¢

- **TritonPart åŸä½œè€…**: UCSD VLSI CAD Lab
- **OpenSTA**: Parallax Software
- **OpenROAD é¡¹ç›®ç»„**: æä¾›åŸå§‹ä»£ç åŸºç¡€

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ GitHub Issues è”ç³»ã€‚

---

**æœ€åæ›´æ–°**: 2024å¹´12æœˆ6æ—¥  
**ç‰ˆæœ¬**: v1.0.0  
**çŠ¶æ€**: ç”Ÿäº§å°±ç»ª âœ…
